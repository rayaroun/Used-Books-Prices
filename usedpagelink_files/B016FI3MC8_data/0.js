/*! For license information please see 0.2fdea19ea397eeb732ff.chunk.min.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{224:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t){if(!t.ok||t.status>=400){var e={type:"generic",response:t};return Promise.reject(e)}return Promise.resolve(t)},r=function(t,e,n){void 0===n&&(n=0);var s=i({mode:"cors",credentials:"same-origin"},e);return fetch(t,s).catch((function(t){if(navigator.onLine){var e={type:"connection",error:t};return Promise.reject(e)}var n={type:"offline",error:t};return Promise.reject(n)})).then(o).catch((function(e){return 3===n?Promise.reject(e):new Promise((function(e,i){setTimeout((function(){r(t,s,n+1).then(e).catch(i)}),3e3)}))}))},s=function(t,e){return void 0===e&&(e={}),r(t,e)}},238:function(t,e,n){window,t.exports=function(){return e=[function(t,e,n){var i;void 0===(i=function(t,e){"use strict";var n,i,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=e.PageLabel||(e.PageLabel={})).A="a",o.R="r",o.I="i",(i=e.KeywordStatus||(e.KeywordStatus={}))[i.FOUND=0]="FOUND",i[i.IMPOSSIBLE=1]="IMPOSSIBLE",i[i.POSSIBLE=2]="POSSIBLE",(n=e.DisclaimerType||(e.DisclaimerType={}))[n.GENERIC=0]="GENERIC",n[n.SPECIFIC_PAGES_MISSING=1]="SPECIFIC_PAGES_MISSING"}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i;void 0===(i=function(t,e){"use strict";var n,i,o;Object.defineProperty(e,"__esModule",{value:!0}),(o=e.Status||(e.Status={})).READY="ready",o.LOADING="loading",o.ERROR="error",(i=e.ReadStatus||(e.ReadStatus={})).END="end",i.READING="reading",(n=e.PageLoadStatus||(e.PageLoadStatus={})).UNLOADED="unloaded",n.LOADING="loading",n.LOADED="loaded",e.callRenderStatusChanged=function(t,e,n){if(t.onRenderStatusChanged)return t.onRenderStatusChanged(e,n)},e.callReadingStatusChanged=function(t,e){if(t.onReadingStatusChanged)return t.onReadingStatusChanged(e)},e.showContent=function(t,e){t.style.visibility=e?"visible":"hidden"},e.isEqualRenderSettings=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;return!0}}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i;void 0===(i=function(t,e){"use strict";function n(t){return 11.93*t}Object.defineProperty(e,"__esModule",{value:!0}),e.binarySearch=function(t,e,n){for(var i,o=0,r=t.length-1;o<=r;){var s=e(t[i=Math.floor(o+(r-o)/2)]);if(s===n)return i;n<s?r=i-1:o=i+1}return Math.min(o,t.length-1)},e.getFirstElementChild=function(t){for(var e=t.childNodes,n=0;n<e.length;n++){var i=e[n];if(i.nodeType===Node.ELEMENT_NODE)return i}return null},e.getAlphabetWidth=n,e.getLargeFontSizeFactor=function(t,e,i){var o=0,r=n(t),s=e/r,a=1.2*i/r,l=Math.min(s,a);return l<1.3&&(o=1.3-l),o<=0?1:o<=.35?1-1.5*o:o<=.55?.5-1*(o-.35):Math.max(0,.3-1.5*(o-.55))},e.isBlockImage=function(t){return"DIV"===t.parentElement.tagName&&1===t.parentElement.childNodes.length};var i={thin:"100",ultra_light:"200",light:"300",book:"normal",normal:"normal",medium:"500",semi_bold:"600",bold:"bold",ultra_bold:"800",heavy:"900",ultra_heavy:"1000"};e.mapYJFontWeight=function(t){return i[t]||"normal"},e.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))},e.isMouseEvent=function(t){return"x"in t}}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.extraEventListeners=[],this.scrollModelConfig=t,this.scrollContainer=t.scrollContainer}return t.prototype.clear=function(){this.scrollEventListener&&this.getContainer().removeEventListener("scroll",this.scrollEventListener),this.touchStartEventListener&&(this.getContainer().removeEventListener("touchstart",this.touchStartEventListener),this.removeTouchStartedEventListeners())},t.prototype.disableScroll=function(){this.scrollContainer&&(this.scrollContainer.style.overflow="hidden")},t.prototype.enableScroll=function(){this.scrollContainer&&(this.scrollContainer.style.overflow="")},t.prototype.addEventListener=function(t,e){this.getContainer().addEventListener(t,e),this.extraEventListeners.push([t,e])},t.prototype.attachEventListeners=function(){this.attachScrollEventListener(),this.attachTouchEventListener()},t.prototype.getContentOffset=function(t){return this.getScrollY()-t},t.prototype.getScrollX=function(){return this.scrollContainer?this.scrollContainer.scrollLeft:window.scrollX},t.prototype.getScrollY=function(){return this.scrollContainer?this.scrollContainer.scrollTop:window.pageYOffset},t.prototype.getLeftOffset=function(){return this.scrollContainer?this.scrollContainer.getBoundingClientRect().left:0},t.prototype.getTopOffset=function(){return this.scrollContainer?this.scrollContainer.getBoundingClientRect().top:0},t.prototype.getContainerWidth=function(){return this.scrollContainer?this.scrollContainer.clientWidth:window.innerWidth},t.prototype.setScrollY=function(t){this.scrollTo(0,t)},t.prototype.scrollTo=function(t,e){this.scrollContainer?(this.scrollContainer.scrollLeft=t,this.scrollContainer.scrollTop=e):this.getContainer().scrollTo(t,e)},t.prototype.isAtEndOfBook=function(){return Math.floor(this.getContainerScrollHeight()-(this.getScrollY()+this.getContainerHeight()))<=0},t.prototype.removeTouchStartedEventListeners=function(){var t=this;this.getContainer().removeEventListener("touchmove",this.touchMoveEventListener),this.getContainer().removeEventListener("touchend",this.touchEndEventListener),this.getContainer().removeEventListener("touchcancel",this.touchEndEventListener),this.extraEventListeners.forEach((function(e){var n=e[0],i=e[1];t.getContainer().removeEventListener(n,i)}))},t.prototype.attachTouchEventListener=function(){var t=this,e=!1,n=0;this.touchStartEventListener=function(e){if(t.isAtEndOfBook()){var i=e.changedTouches[0];n=i.clientY,t.getContainer().addEventListener("touchmove",t.touchMoveEventListener),t.getContainer().addEventListener("touchend",t.touchEndEventListener),t.getContainer().addEventListener("touchcancel",t.touchCancelEventListener)}},this.touchMoveEventListener=function(t){var i=t.changedTouches[0];10<=n-i.clientY&&(e=!0)},this.touchEndEventListener=function(n){e&&t.scrollModelConfig.scrollCallback(),e=!1,t.removeTouchStartedEventListeners()},this.touchCancelEventListener=function(){e=!1,t.removeTouchStartedEventListeners()},this.getContainer().addEventListener("touchstart",this.touchStartEventListener)},t.prototype.attachScrollEventListener=function(){var t=this,e=!1;this.scrollEventListener=function(n){t.scrollModelConfig.scrollCallback(),e||(e=!0,setTimeout((function(){t.scrollModelConfig.throttledScrollCallback&&t.scrollModelConfig.throttledScrollCallback(),e=!1}),250))},this.getContainer().addEventListener("scroll",this.scrollEventListener)},t.prototype.getContainerScrollHeight=function(){return this.scrollContainer?this.scrollContainer.scrollHeight:document.documentElement.scrollHeight},t.prototype.getContainerHeight=function(){return this.scrollContainer?this.scrollContainer.clientHeight:window.innerHeight},t.prototype.getContainer=function(){return this.scrollContainer?this.scrollContainer:window},t}();e.ScrollModel=n}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i;void 0===(i=function(t,e){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Default=0]="Default",t[t.Night=1]="Night",t[t.Sepia=2]="Sepia",t[t.Green=3]="Green"}(n=e.ColorTheme||(e.ColorTheme={})),e.COLOR_THEMES_STYLE={},e.COLOR_THEMES_STYLE[n[n.Default]]={textColor:"#000000",backgroundColor:"#ffffff",searchHighlightStyle:{backgroundColor:"#cacaca",textDecoration:"underline #000000"}},e.COLOR_THEMES_STYLE[n[n.Night]]={textColor:"#acacac",backgroundColor:"#121212",searchHighlightStyle:{backgroundColor:"#cacaca",textDecoration:"underline #000000"}},e.COLOR_THEMES_STYLE[n[n.Sepia]]={textColor:"#5d4232",backgroundColor:"#e7dec7",searchHighlightStyle:{backgroundColor:"#cacaca",textDecoration:"underline #000000"}},e.COLOR_THEMES_STYLE[n[n.Green]]={textColor:"#3a4b43",backgroundColor:"#c5e7ce",searchHighlightStyle:{backgroundColor:"#cacaca",textDecoration:"underline #000000"}}}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i,o;i=[n,e,n(6),n(9),n(0),n(1)],void 0===(o=function(t,e,n,i,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BookViewerPrint=n.BookViewerPrint,e.SURPRISE_ME_POSITION=n.SURPRISE_ME_POSITION,e.BookViewerReflowable=i.BookViewerReflowable,e.PageLabel=o.PageLabel,e.ReadStatus=r.ReadStatus,e.PageLoadStatus=r.PageLoadStatus,e.Status=r.Status}.apply(e,i))||(t.exports=o)},function(t,e,n){var i,o,r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};i=[n,e,n(3),n(0),n(1),n(7)],void 0===(o=function(t,e,n,i,o,s){"use strict";function a(t){return!t||"Embargoed Page"===t}function l(t,e){if(t.pageLabel===i.PageLabel.A)return e-t.firstPageIdx+t.actualPageNumber}Object.defineProperty(e,"__esModule",{value:!0}),e.SURPRISE_ME_POSITION=-999;var h=function(){function t(t,e,i){var o=this;this.defaultMinHeight=400,this.pageTokens={},this.searchHighlights=[],this.bookProvider=e,this.viewerConfig=t,this.viewerRoot=t.viewerRoot,this.renderSettings=i,this.pages=[],this.defaultWidth=this.viewerRoot.clientWidth,this.scrollModel=new n.ScrollModel({scrollCallback:function(){return o.callReadingStatusChangedOnScroll()},scrollContainer:this.viewerConfig.scrollContainer}),this.gestureHandler=new s.GestureHandlerScale(this.viewerRoot,this.scrollModel,this.onPageZoom.bind(this)),this.intersectionObserver=new IntersectionObserver((function(t){return o.loadMorePages(t)}),{threshold:.1}),this.displayBook()}return t.prototype.setDefaultWidth=function(t){this.defaultWidth=t,this.gestureHandler.setInitialWidth(t)},t.prototype.goToPosition=function(t,n){var i=this,o=this.getPageContainer(t);if(o){this.fetchPageSearchHighlights(t);var r=this.viewerRoot.clientWidth-this.scrollModel.getContainerWidth();this.scrollModel.scrollTo(r/2,o.offsetTop)}else"Embargoed Page"!==this.pages[t]&&(t===e.SURPRISE_ME_POSITION?this.bookProvider.getRandomPage().then((function(t){i.pageTokens[t.pageNumber]=t.token,i.setPages(t.jumboImageUrls),i.goToPosition(t.pageNumber,t.token)})):0<=t&&(this.pages[t]=this.pages[t]||"Loading Page",this.fetchPage(t,n).then((function(){i.fetchNeighborPages(t,n,!0)}))))},t.prototype.applyRenderSettings=function(t){var e=this;this.renderSettings=r({},this.renderSettings,t),t.isRendererPropagatedZoom||new Promise((function(t){e.gestureHandler.zoom(e.getScaleFromZoomPercent()),t()}))},t.prototype.clear=function(){this.viewerRoot.innerHTML="",this.scrollModel.clear(),this.gestureHandler.disconnect()},t.prototype.setSearchInfo=function(t){for(var e in this.searchQuery=t.query,t.tokens)this.pageTokens[e]=t.tokens[e]},t.prototype.clearSearchHighlights=function(){document.querySelectorAll(".search-highlight").forEach((function(t){return t.remove()})),this.searchHighlights=[]},t.prototype.setLocalizedStrings=function(t){this.localizedStrings=t,this.resetSampleDisclaimers()},t.prototype.callRenderStatusReady=function(){this.pageLoaded&&this.rendererInitialized&&o.callRenderStatusChanged(this.viewerConfig,o.Status.READY)},t.prototype.displayBook=function(){var t=this;o.callRenderStatusChanged(this.viewerConfig,o.Status.LOADING),this.bookProvider.getManifest().then((function(e){return t.manifest=e,t.initializePages(e.pages,e.embargoedPages,e.imageUrls)})).then((function(){t.appendPages(),t.appendSampleDisclaimers(),t.scrollModel.attachEventListeners(),t.rendererInitialized||(t.rendererInitialized=!0,t.callRenderStatusReady())})).catch((function(e){o.callRenderStatusChanged(t.viewerConfig,o.Status.ERROR,e)}))},t.prototype.initializePages=function(t,e,n){var i=this;return new Promise((function(o){if(n){for(var r in t.forEach((function(t){i.pages[t]="Loading Page"})),e.forEach((function(t){i.pages[t]="Embargoed Page"})),n)i.isPendingPage(parseInt(r,10))&&(i.pages[r]=n[r]);o()}else i.fetchPage(t[0]).then((function(){o()}))}))},t.prototype.appendPages=function(){var t=this;this.viewerRoot.innerHTML="",this.pages.forEach((function(e,n){var i=t.createPageContainer(n);if(!a(e)){if(function(t){return"Loading Page"===t}(e))i.insertAdjacentHTML("beforeend",t.getSpinner(n));else{var o=t.getPageImage(n,e);o.onload=function(){(400===t.defaultMinHeight||o.clientHeight<t.defaultMinHeight)&&0<o.clientHeight&&(t.defaultMinHeight=o.clientHeight),document.querySelectorAll("[data-page]").forEach((function(e){e.style.minHeight=t.defaultMinHeight+"px"})),t.hideSpinner(n),t.pageLoaded||(t.pageLoaded=!0,t.callRenderStatusReady())},i.appendChild(o),i.insertAdjacentHTML("beforeend",t.getSpinner(n)),t.gestureHandler.observe(i,t.getGestureOptions())}t.viewerRoot.insertAdjacentElement("beforeend",i),t.intersectionObserver.observe(i)}}))},t.prototype.appendSampleDisclaimers=function(){for(var t,e,n=1;n<=this.manifest.numberOfPages;n++)if(a(this.pages[n]))t=t||n,e=n;else if(t&&e){var o;o=this.manifest.firstPageInfo&&t>this.manifest.firstPageInfo.firstPageIdx?this.createDisclaimer(this.getSampleDisclaimerText(i.DisclaimerType.SPECIFIC_PAGES_MISSING,{startMissingPageIdx:t,endMissingPageIdx:e,firstPageInfo:this.manifest.firstPageInfo})):this.createDisclaimer(this.getSampleDisclaimerText(i.DisclaimerType.GENERIC));var r=this.getPageContainer(n);this.viewerRoot.insertBefore(o,r),e=t=null}},t.prototype.stylePageContainer=function(t){t.setAttribute("style","margin-bottom: 10px; box-shadow: 0 0 4px 0 rgba(0,0,0,0.50); overflow: hidden; position: relative; min-height: "+this.defaultMinHeight+"px")},t.prototype.getPageImage=function(t,e){var n=document.createElement("img");return n.alt="Page "+t,n.src=e,n.draggable=!1,n.style.display="block",n.style.height="100%",n.style.width="100%",n.style.objectFit="contain",n},t.prototype.loadMorePages=function(t){var e=this;t.forEach((function(t){if(t.isIntersecting){var n=t.target.dataset.page;if(n){var i=parseInt(n,10);e.fetchNeighborPages(i,e.pageTokens[i]),e.fetchNeighborHighlights(i)}}}))},t.prototype.fetchNeighborPages=function(t,e,n){var i=this;this.fetchPage(t-1,e).then((function(){return i.navigateToPage(t,n)})),this.fetchPage(t,e).then((function(){return i.navigateToPage(t,n)})),this.fetchPage(t+1,e).then((function(){return i.navigateToPage(t,n)}))},t.prototype.fetchNeighborHighlights=function(t){this.searchQuery&&(this.fetchPageSearchHighlights(t-1),this.fetchPageSearchHighlights(t),this.fetchPageSearchHighlights(t+1))},t.prototype.isPendingPage=function(t){return!this.pages[t]||"Loading Page"===this.pages[t]},t.prototype.isValidPage=function(t,e){return e?0<t&&t<=e:-1<this.manifest.pages.indexOf(t)},t.prototype.fetchPage=function(t,e){var n=this;return this.isPendingPage(t)&&this.isValidPage(t,this.manifest.numberOfPages)?this.bookProvider.getPageUrls(t,e).then((function(t){t&&n.setPages(t)})):Promise.resolve()},t.prototype.fetchPageSearchHighlights=function(t){var e=this;return!this.searchQuery||this.searchHighlights[t]||a(t.toString())?Promise.resolve():this.bookProvider.getPageSearchHighlights(this.searchQuery,t,this.pageTokens[t]).then((function(n){if(function(t){return"highlights"in t}(n)){var i=function(t){var i=e.getPageContainer(parseInt(t,10));i.querySelectorAll(".search-highlight").forEach((function(t){return t.remove()})),e.searchHighlights[t]=n.highlights[t],e.searchHighlights[t].forEach((function(t){i.appendChild(e.createHighlight({left:parseInt(t[0],10)*(100/1024)+"%",top:parseInt(t[1],10)*(100/1024)+"%",width:parseInt(t[2],10)*(100/1024)+"%",height:parseInt(t[3],10)*(100/1024)+"%"}))}))};for(var o in n.highlights)i(o)}else e.searchHighlights[t]=[]}))},t.prototype.setPages=function(t){for(var e in t){var n=parseInt(e,10);this.isPendingPage(n)&&this.setPage(n,t[n])}},t.prototype.setPage=function(t,e){var n=this;this.pages[t]=e;var i=this.getPageImage(t,e);i.onload=function(){n.hideSpinner(t),n.pageLoaded||(n.pageLoaded=!0,n.callRenderStatusReady())};var o=this.getPageContainer(t);if(!o){var r=this.getLastRenderedPageNumber();o=this.createPageContainer(t),r<t?this.viewerRoot.appendChild(o):this.viewerRoot.insertBefore(o,this.getNextAvailablePage(t)),this.intersectionObserver.observe(o)}var s=o.querySelectorAll(".search-highlight");o.innerHTML="",o.appendChild(i),o.insertAdjacentHTML("beforeend",this.getSpinner(t)),s.forEach((function(t){o.appendChild(t)})),this.gestureHandler.observe(o,this.getGestureOptions()),this.resetSampleDisclaimers()},t.prototype.clearSamplePageDisclaimers=function(){document.querySelectorAll(".sample-page-disclaimer").forEach((function(t){t.remove()}))},t.prototype.callReadingStatusChangedOnScroll=function(){this.scrollModel.isAtEndOfBook()?o.callReadingStatusChanged(this.viewerConfig,o.ReadStatus.END):o.callReadingStatusChanged(this.viewerConfig,o.ReadStatus.READING)},t.prototype.createPageContainer=function(t){var e=document.createElement("div");return e.dataset.page=t.toString(),this.stylePageContainer(e),e},t.prototype.createHighlight=function(t){var e=document.createElement("div");return e.className="search-highlight",e.style.position="absolute",e.style.background="rgba(0,0,0,0.20)",e.style.borderBottom="2px solid #000000",e.style.left=t.left,e.style.top=t.top,e.style.width=t.width,e.style.height=t.height,e},t.prototype.createDisclaimer=function(t){var e=document.createElement("div");return e.innerHTML=t,e.style.backgroundColor="#CDE6E0",e.style.textAlign="center",e.style.fontSize="14px",e.style.paddingTop="7px",e.style.paddingBottom="7px",e.style.marginBottom="10px",e.className="sample-page-disclaimer",e},t.prototype.getNextAvailablePage=function(t){for(var e=t+1;a(this.pages[e])&&e<this.pages.length;)e++;return this.getPageContainer(e)},t.prototype.getLastRenderedPageNumber=function(){for(var t=this.pages.length-1;0<=t;t--)if(!a(this.pages[t])&&this.getPageContainer(t))return t;return 0},t.prototype.navigateToPage=function(t,e){e&&this.goToPosition(t)},t.prototype.getScaleFromZoomPercent=function(){return this.renderSettings.zoomPercent/100},t.prototype.getGestureOptions=function(){return{defaultWidth:this.defaultWidth,viewportTopOffset:this.renderSettings.viewportTopOffset}},t.prototype.getPageContainer=function(t){return document.querySelector('[data-page="'+t+'"]')},t.prototype.getSampleDisclaimerText=function(t,e){if(!this.localizedStrings)return"";switch(t){case i.DisclaimerType.SPECIFIC_PAGES_MISSING:if(!e||!this.localizedStrings.getMissingPageMessage||!this.localizedStrings.getMissingPagesMessage)return"";var n=l(e.firstPageInfo,e.startMissingPageIdx);if(e.startMissingPageIdx===e.endMissingPageIdx)return this.localizedStrings.getMissingPageMessage(n);var o=l(e.firstPageInfo,e.endMissingPageIdx);return this.localizedStrings.getMissingPagesMessage(n,o);case i.DisclaimerType.GENERIC:default:return this.localizedStrings.genericSampleMessage||""}},t.prototype.onPageZoom=function(t,e){this.viewerConfig.onZoom(100*t),this.viewerConfig.isManga||this.gestureHandler.zoom(t,e)},t.prototype.getSpinner=function(t){return'\n            <div id="'+this.getSpinnerId(t)+'" style="position: absolute; left: 0; right: 0; bottom: 0; top: 0; height: 40px; width: 40px; margin: auto; animation: spin 1s linear infinite;">\n                <svg version="1.1" id="Layer_1" x="0px" y="0px"\n                    viewBox="0 0 80 80" enable-background="new 0 0 80 80" xml:space="preserve">\n                    <path id="spinner-'+t+'" fill="#B8B8B8" d="M40,72C22.4,72,8,57.6,8,40C8,22.4,22.4,8,40,8c17.6,0,32,14.4,32,32c0,1.1-0.9,2-2,2s-2-0.9-2-2c0-15.4-12.6-28-28-28S12,24.6,12,40s12.6,28,28,28c1.1,0,2,0.9,2,2S41.1,72,40,72z"/>\n                </svg>\n            </div>\n        '},t.prototype.getSpinnerId=function(t){return"PrintSpinner"+t},t.prototype.hideSpinner=function(t){document.getElementById(this.getSpinnerId(t)).style.display="none"},t.prototype.resetSampleDisclaimers=function(){this.clearSamplePageDisclaimers(),this.appendSampleDisclaimers()},t}();e.BookViewerPrint=h}.apply(e,i))||(t.exports=o)},function(t,e,n){var i,o;i=[n,e,n(8),n(2)],void 0===(o=function(t,e,n,i){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.PINCH="pinch",t.PINCH_CANCEL="pinchcancel",t.PINCH_END="pinchend",t.PINCH_MOVE="pinchmove"}(o=o||{});var r=o.PINCH+" "+o.PINCH_MOVE,s=function(){function t(t,e,n){this.displayImageScale=1,this.pinchStartEventListener=this.onPinchStart.bind(this),this.touchPadPinchEventListener=this.onTouchPadPinchZoom.bind(this),this.panStartEventListener=this.onPanStart.bind(this),this.panMoveEventListener=this.onPanMove.bind(this),this.panEndEventListener=this.onPanEnd.bind(this),this.doubleTapEventListener=this.onDoubleTap.bind(this),this.panning=!1,this.viewerRoot=t,this.observedElements=[],this.onZoom=n,this.scrollModel=e,this.initialize(),this.attachEventListeners()}return t.prototype.observe=function(t,e){this.observedElements.push(t),this.initialWidth||(this.initialWidth=e.defaultWidth)},t.prototype.setInitialWidth=function(t){this.initialWidth=t},t.prototype.disconnect=function(){this.removeEventListeners(),this.observedElements=[]},t.prototype.zoom=function(t,e,n,o){var r=this;if(i.clamp(t,1,2)!==this.displayImageScale){var s=e;if(!s){var a=this.observedElements.filter((function(t){return r.elementIsInViewport(t)})),l=a.map(this.getElementHeightInViewport.bind(this)),h=0;a.forEach((function(t,e){l[e]>h&&(h=l[e],s=t)}))}var c=this.getScrollModel().getLeftOffset()-s.getBoundingClientRect().left,u=this.getScrollModel().getTopOffset()-s.getBoundingClientRect().top,d=this.getScale();this.setScale(t),this.getViewerRoot().parentElement.style.width=this.initialWidth*this.getScale()+"px";var p=this.getZoomedScrollX(s,c,d,n),g=this.getZoomedScrollY(s,u,d,o);this.centerPage(p,g)}},t.prototype.getScrollModel=function(){return this.scrollModel},t.prototype.getViewerRoot=function(){return this.viewerRoot},t.prototype.getScale=function(){return this.displayImageScale},t.prototype.setScale=function(t){this.displayImageScale=i.clamp(t,1,2),1===this.displayImageScale?this.getViewerRoot().style.cursor="auto":this.getViewerRoot().style.cursor="pointer"},t.prototype.centerPage=function(t,e){var n=this.getScrollModel(),i=this.getViewerRoot().clientWidth-n.getContainerWidth();n.scrollTo(t||i/2,e||n.getScrollY())},t.prototype.initialize=function(){this.manager=new n.Manager(this.getViewerRoot(),{touchAction:"pan-x pan-y"}),this.manager.add(new n.Pinch({enable:!0})),this.manager.add(new n.Tap({event:"doubletap",taps:2}))},t.prototype.attachEventListeners=function(){this.manager.on(r,this.pinchStartEventListener),this.manager.on("doubletap",this.doubleTapEventListener),this.getViewerRoot().addEventListener("gesturechange",this.pinchStartEventListener),this.getViewerRoot().addEventListener("wheel",this.touchPadPinchEventListener),this.getViewerRoot().addEventListener("mousedown",this.panStartEventListener),this.getViewerRoot().addEventListener("mousemove",this.panMoveEventListener),this.getViewerRoot().addEventListener("mouseup",this.panEndEventListener),this.getViewerRoot().addEventListener("mouseleave",this.panEndEventListener)},t.prototype.removeEventListeners=function(){this.manager.off(r,this.pinchStartEventListener),this.manager.off("doubletap",this.doubleTapEventListener),this.getViewerRoot().removeEventListener("gesturechange",this.pinchStartEventListener),this.getViewerRoot().removeEventListener("wheel",this.touchPadPinchEventListener),this.getViewerRoot().removeEventListener("mousedown",this.panStartEventListener),this.getViewerRoot().removeEventListener("mousemove",this.panMoveEventListener),this.getViewerRoot().removeEventListener("mouseup",this.panEndEventListener),this.getViewerRoot().removeEventListener("mouseleave",this.panEndEventListener)},t.prototype.onDoubleTap=function(t){t.preventDefault(),this.getScale()<2?this.zoom(2,t.target,t.center.x,t.center.y):this.zoom(1,t.target,t.center.x,t.center.y),this.onZoom&&this.onZoom(this.displayImageScale,this.getScrollingElement(t.target))},t.prototype.onPinchStart=function(t){t.preventDefault();var e=1<t.scale?1:-1;this.setScale(.01*e+this.getScale()),this.getViewerRoot().parentElement.style.width=this.initialWidth*this.getScale()+"px";var n=this.getViewerRoot().clientWidth-this.getScrollModel().getContainerWidth();this.getScrollModel().scrollTo(n/2,this.getScrollModel().getScrollY())},t.prototype.onTouchPadPinchZoom=function(t){t.ctrlKey&&(t.preventDefault(),this.handlePinchZoom(this.getScale()-.01*t.deltaY,t.target,t.clientX,t.clientY))},t.prototype.handlePinchZoom=function(t,e,n,i){if(e){var o=this.getScrollingElement(e);this.zoom(t,o,n,i),this.onZoom&&this.onZoom(this.displayImageScale,o)}},t.prototype.onPanStart=function(t){this.panning=(i.isMouseEvent(t)||1===t.touches.length)&&1<this.getScale(),this.setPointerPosition(t)},t.prototype.onPanMove=function(t){if(this.panning){t.preventDefault();var e=this.getScrollModel(),n=this.pointerPosition.x-a(t),i=this.pointerPosition.y-l(t);e.scrollTo(e.getScrollX()+n,e.getScrollY()+i),this.setPointerPosition(t)}},t.prototype.onPanEnd=function(){this.panning=!1},t.prototype.setPointerPosition=function(t){i.isMouseEvent(t)?this.pointerPosition={x:t.x,y:t.y}:this.pointerPosition={x:t.touches[0].clientX,y:t.touches[0].clientY}},t.prototype.getScrollingElement=function(t){var e=t;return e&&"IMG"===e.nodeName&&(e=e.parentElement),e},t.prototype.getZoomedScrollX=function(t,e,n,i){var o=i?i-this.getScrollModel().getLeftOffset():.5*this.getScrollModel().getContainerWidth(),r=(e+o)/n*this.getScale()-o;return t.offsetLeft+r},t.prototype.getZoomedScrollY=function(t,e,n,i){var o=i?i-this.getScrollModel().getTopOffset():.5*this.getScrollModel().getContainerHeight(),r=(e+o)/n*this.getScale()-o;return t.offsetTop+r},t.prototype.elementIsInViewport=function(t){var e=this.getElementPositionsRelativeToScrollContainer(t);return e.top>=-t.offsetHeight&&e.bottom<=this.getScrollModel().getContainerHeight()+t.offsetHeight},t.prototype.getElementPositionsRelativeToScrollContainer=function(t){var e=t.getBoundingClientRect();return{top:e.top-this.getScrollModel().getTopOffset(),bottom:e.bottom-this.getScrollModel().getTopOffset()}},t.prototype.getElementHeightInViewport=function(t){var e=this.getElementPositionsRelativeToScrollContainer(t),n=t.offsetHeight;e.top<0&&(n+=e.top);var i=this.getScrollModel().getContainerHeight();return e.bottom>i&&(n+=i-e.bottom),n},t}();e.GestureHandlerScale=s;var a=function(t){return i.isMouseEvent(t)?t.x:t.touches[0].clientX},l=function(t){return i.isMouseEvent(t)?t.y:t.touches[0].clientY}}.apply(e,i))||(t.exports=o)},function(t,e,n){var i;!function(o,r,s,a){"use strict";var l,h=["","webkit","Moz","MS","ms","o"],c=r.createElement("div"),u=Math.round,d=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(P(t,n),e)}function f(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function m(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=o.console&&(o.console.warn||o.console.log);return r&&r.call(o.console,i,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}:Object.assign;var y=m((function(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;)(!n||n&&t[i[o]]===a)&&(t[i[o]]=e[i[o]]),o++;return t}),"extend","Use `assign`."),S=m((function(t,e){return y(t,e,!0)}),"merge","Use `assign`.");function E(t,e,n){var i,o=e.prototype;(i=t.prototype=Object.create(o)).constructor=t,i._super=o,n&&l(i,n)}function P(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function C(t,e){return t===a?e:t}function b(t,e,n){v(R(e),(function(e){t.addEventListener(e,n,!1)}))}function T(t,e,n){v(R(e),(function(e){t.removeEventListener(e,n,!1)}))}function I(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function L(t,e){return-1<t.indexOf(e)}function R(t){return t.trim().split(/\s+/g)}function x(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function M(t){return Array.prototype.slice.call(t,0)}function k(t,e,n){for(var i=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];x(o,s)<0&&i.push(t[r]),o[r]=s,r++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function O(t,e){for(var n,i,o=e[0].toUpperCase()+e.slice(1),r=0;r<h.length;){if((i=(n=h[r])?n+o:e)in t)return i;r++}return a}var H=1;function A(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||o}var D="ontouchstart"in o,F=O(o,"PointerEvent")!==a,_=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N=24,B=["x","y"],z=["clientX","clientY"];function W(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function V(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,r=1&e&&i-o==0,s=12&e&&i-o==0;n.isFirst=!!r,n.isFinal=!!s,r&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=Y(e)),1<o&&!n.firstMultiple?n.firstMultiple=Y(e):1===o&&(n.firstMultiple=!1);var r=n.firstInput,s=n.firstMultiple,l=s?s.center:r.center,h=e.center=j(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=U(l,h),e.distance=K(l,h),function(t,e){var n=e.center,i=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=o.x+(n.x-i.x),e.deltaY=o.y+(n.y-i.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var c,u,g=G(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=g.x,e.overallVelocityY=g.y,e.overallVelocity=d(g.x)>d(g.y)?g.x:g.y,e.scale=s?(c=s.pointers,K((u=i)[0],u[1],z)/K(c[0],c[1],z)):1,e.rotation=s?function(t,e){return U(e[1],e[0],z)+U(t[1],t[0],z)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,o,r,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(25<l||s.velocity===a)){var h=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,u=G(l,h,c);i=u.x,o=u.y,n=d(u.x)>d(u.y)?u.x:u.y,r=q(h,c),t.lastInterval=e}else n=s.velocity,i=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=o,e.direction=r}(n,e);var f=t.element;I(e.srcEvent.target,f)&&(f=e.srcEvent.target),e.target=f}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function Y(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:u(t.pointers[n].clientX),clientY:u(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:j(e),deltaX:t.deltaX,deltaY:t.deltaY}}function j(t){var e=t.length;if(1===e)return{x:u(t[0].clientX),y:u(t[0].clientY)};for(var n=0,i=0,o=0;o<e;)n+=t[o].clientX,i+=t[o].clientY,o++;return{x:u(n/e),y:u(i/e)}}function G(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:d(t)>=d(e)?t<0?2:4:e<0?8:16}function K(t,e,n){var i=e[(n=n||B)[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return Math.sqrt(i*i+o*o)}function U(t,e,n){var i=e[(n=n||B)[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return 180*Math.atan2(o,i)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&b(this.element,this.evEl,this.domHandler),this.evTarget&&b(this.target,this.evTarget,this.domHandler),this.evWin&&b(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(A(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4},Z="mousedown",J="mousemove mouseup";function Q(){this.evEl=Z,this.evWin=J,this.pressed=!1,W.apply(this,arguments)}E(Q,W,{handler:function(t){var e=X[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var $={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},tt={2:"touch",3:"pen",4:"mouse",5:"kinect"},et="pointerdown",nt="pointermove pointerup pointercancel";function it(){this.evEl=et,this.evWin=nt,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(et="MSPointerDown",nt="MSPointerMove MSPointerUp MSPointerCancel"),E(it,W,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),o=$[i],r=tt[t.pointerType]||t.pointerType,s="touch"==r,a=x(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),n&&e.splice(a,1))}});var ot={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function rt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,W.apply(this,arguments)}E(rt,W,{handler:function(t){var e=ot[t.type];if(1===e&&(this.started=!0),this.started){var n=function(t,e){var n=M(t.touches),i=M(t.changedTouches);return 12&e&&(n=k(n.concat(i),"identifier",!0)),[n,i]}.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var st={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at="touchstart touchmove touchend touchcancel";function lt(){this.evTarget=at,this.targetIds={},W.apply(this,arguments)}function ht(){W.apply(this,arguments);var t=P(this.handler,this);this.touch=new lt(this.manager,t),this.mouse=new Q(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);-1<t&&i.splice(t,1)}),2500)}}E(lt,W,{handler:function(t){var e=st[t.type],n=function(t,e){var n=M(t.touches),i=this.targetIds;if(3&e&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,r,s=M(t.changedTouches),a=[],l=this.target;if(r=n.filter((function(t){return I(t.target,l)})),1===e)for(o=0;o<r.length;)i[r[o].identifier]=!0,o++;for(o=0;o<s.length;)i[s[o].identifier]&&a.push(s[o]),12&e&&delete i[s[o].identifier],o++;return a.length?[k(r.concat(a),"identifier",!0),a]:void 0}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),E(ht,W,{handler:function(t,e,n){var i="touch"==n.pointerType,o="mouse"==n.pointerType;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)(function(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ct.call(this,e)):12&t&&ct.call(this,e)}).call(this,e,n);else if(o&&function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var o=this.lastTouches[i],r=Math.abs(e-o.x),s=Math.abs(n-o.y);if(r<=25&&s<=25)return!0}return!1}.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ut=O(c.style,"touchAction"),dt=ut!==a,pt=function(){if(!dt)return!1;var t={},e=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||o.CSS.supports("touch-action",n)})),t}();function gt(t,e){this.manager=t,this.set(e)}function ft(t){this.options=l({},this.defaults,t||{}),this.id=H++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function vt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function mt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function yt(t,e){var n=e.manager;return n?n.get(t):t}function St(){ft.apply(this,arguments)}function Et(){St.apply(this,arguments),this.pX=null,this.pY=null}function Pt(){St.apply(this,arguments)}function wt(){ft.apply(this,arguments),this._timer=null,this._input=null}function Ct(){St.apply(this,arguments)}function bt(){St.apply(this,arguments)}function Tt(){ft.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function It(t,e){return(e=e||{}).recognizers=C(e.recognizers,It.defaults.preset),new Lt(t,e)}function Lt(t,e){var n;this.options=l({},It.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(F?it:_?lt:D?ht:Q))(n,V),this.touchAction=new gt(this,this.options.touchAction),Rt(this,!0),v(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Rt(t,e){var n,i=t.element;i.style&&(v(t.options.cssProps,(function(o,r){n=O(i.style,r),e?(t.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}gt.prototype={set:function(t){"compute"==t&&(t=this.compute()),dt&&this.manager.element.style&&pt[t]&&(this.manager.element.style[ut]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(L(t,"none"))return"none";var e=L(t,"pan-x"),n=L(t,"pan-y");return e&&n?"none":e||n?e?"pan-x":"pan-y":L(t,"manipulation")?"manipulation":"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,o=L(i,"none")&&!pt.none,r=L(i,"pan-y")&&!pt["pan-y"],s=L(i,"pan-x")&&!pt["pan-x"];if(o){var a=1===t.pointers.length,l=t.distance<2,h=t.deltaTime<250;if(a&&l&&h)return}if(!s||!r)return o||r&&6&n||s&&n&N?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}},ft.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(f(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=yt(t,this)).id]||(e[t.id]=t).recognizeWith(this),this},dropRecognizeWith:function(t){return f(t,"dropRecognizeWith",this)||(t=yt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(f(t,"requireFailure",this))return this;var e=this.requireFail;return-1===x(e,t=yt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(f(t,"dropRequireFailure",this))return this;t=yt(t,this);var e=x(this.requireFail,t);return-1<e&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<8&&i(e.options.event+vt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),8<=n&&i(e.options.event+vt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},E(St,ft,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=6&e,o=this.attrTest(t);return i&&(8&n||!o)?16|e:i||o?4&n?8|e:2&e?4|e:2:32}}),E(Et,St,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),t&N&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(i=6&e.direction?(o=0===r?1:r<0?2:4,n=r!=this.pX,Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,n=s!=this.pY,Math.abs(t.deltaY))),t.direction=o,n&&i>e.threshold&&o&e.direction},attrTest:function(t){return St.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=mt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),E(Pt,St,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),E(wt,ft,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!i||!n||12&t.eventType&&!o)this.reset();else if(1&t.eventType)this.reset(),this._timer=g((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),E(Ct,St,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),E(bt,St,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Et.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&N&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=mt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),E(Tt,ft,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(i&&o&&n){if(4!=t.eventType)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||K(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&r?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=g((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),It.VERSION="2.0.7",It.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Ct,{enable:!1}],[Pt,{enable:!1},["rotate"]],[bt,{direction:6}],[Et,{direction:6},["swipe"]],[Tt],[Tt,{event:"doubletap",taps:2},["tap"]],[wt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Lt.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(o=e.curRecognizer=null);for(var r=0;r<i.length;)n=i[r],2===e.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(t),!o&&14&n.state&&(o=e.curRecognizer=n),r++}},get:function(t){if(t instanceof ft)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(f(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),(t.manager=this).touchAction.update(),t},remove:function(t){if(f(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=x(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return v(R(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return v(R(t),(function(t){e?n[t]&&n[t].splice(x(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=r.createEvent("Event");n.initEvent(t,!0,!0),(n.gesture=e).target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&Rt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(It,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:N,DIRECTION_ALL:30,Manager:Lt,Input:W,TouchAction:gt,TouchInput:lt,MouseInput:Q,PointerEventInput:it,TouchMouseInput:ht,SingleTouchInput:rt,Recognizer:ft,AttrRecognizer:St,Tap:Tt,Pan:Et,Swipe:bt,Pinch:Pt,Rotate:Ct,Press:wt,on:b,off:T,each:v,merge:S,extend:y,assign:l,inherit:E,bindFn:P,prefixed:O}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=It,(i=function(){return It}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},function(t,e,n){var i,o,r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};i=[n,e,n(4),n(10),n(3),n(2),n(11),n(12),n(1)],void 0===(o=function(t,e,n,i,o,s,a,l,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultRenderSettings={font:"Bookerly",fontSize:16,lineHeightFactor:1.3525,leftAlign:!1,marginTop:20,marginRight:14.67,marginBottom:13.33,marginLeft:14.67,colorTheme:n.ColorTheme.Default,viewportHeight:0,viewportWidth:0,viewportTopOffset:0,linkStyle:"color: #0066c0; text-decoration: underline;",disabledLinkStyle:"color: gray; text-decoration: underline;",searchResultItem:null};var c={supportedFontFormats:["woff2"]},u=function(){function t(t,n,s){var a=this;this.viewerRoot=t.viewerRoot,this.bookProvider=n,this.sectionLoader=new i.SectionLoader(n),this.viewerConfig=r({},c,t),this.renderSettings=r({},e.DefaultRenderSettings,s);var l={scrollCallback:function(){return a.callReadingStatusChangedOnScroll()},throttledScrollCallback:function(){return a.setFirstVisibleElementPid()},scrollContainer:this.viewerConfig.scrollContainer};this.scrollModel=new o.ScrollModel(l),this.displayBook()}return t.prototype.clear=function(){for(var t=this.viewerRoot.firstChild;t;)this.viewerRoot.removeChild(t),t=this.viewerRoot.firstChild;document.getElementById("book-stylesheet").remove(),document.getElementById("reader-link-stylesheet").remove(),this.scrollModel.clear(),this.firstVisibleElementPid=0},t.prototype.goToPosition=function(t,e){if(this.pidSortedInfoList){var n=s.binarySearch(this.pidSortedInfoList,(function(t){return t.pid}),t),i=this.pidSortedInfoList[n],o=document.querySelector('[data-pid="'+i.pid+'"]');o?(this.scrollModel.setScrollY(i.pixelPositions.topMargin),e&&o.focus()):console.warn("PID element not found: "+i.pid)}},t.prototype.getCurrentReadingLocationData=function(){var t=this.getFirstVisibleElement();return{currentPositionRange:{topOfFirstVisiblePid:t.pixelPositions.top,bottomOfFirstVisiblePid:t.pixelPositions.bottom},minimumPosition:0,maximumPosition:this.scrollModel.getContainerScrollHeight()}},t.prototype.displayBook=function(){var t=this;h.callRenderStatusChanged(this.viewerConfig,h.Status.LOADING),this.setupReaderFonts(),Promise.all([this.bookProvider.getManifest(),this.bookProvider.getResourceAsString("styles.css"),this.sectionLoader.getAllSections(),this.sectionLoader.getCoverImage(),this.ensureReaderFontLoaded(this.renderSettings.font),this.loadEmbeddedFonts()]).then((function(e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[5];return t.bookManifest=n,t.embeddedFonts=s,h.showContent(t.viewerRoot,!1),document.head.appendChild(t.createBookStylesheetHTML(i)),document.head.appendChild(t.createReaderLinkStylesheetHTML()),t.viewerRoot.style.fontFamily="DefaultFont",t.changeReaderFont(null,t.renderSettings.font),t.applyColorTheme(),t.appendCoverImage(r),t.appendSections(o),t.addAccessibilityTabIndexAttribute(),t.loadImages(),t.changeBackgroundImageUrls(),t.attachAnchorEventHandling(n.sections),t.fixUpLinkStyles(),t.applyLinkStyles(),t.applyHyphenation(n.language),t.applyRenderSettingsInternal(t.renderSettings).then((function(){t.scrollModel.attachEventListeners(),t.goToPosition(n.srl),h.showContent(t.viewerRoot,!0),t.setFirstVisibleElementPid(),h.callRenderStatusChanged(t.viewerConfig,h.Status.READY)}))})).catch((function(e){h.callRenderStatusChanged(t.viewerConfig,h.Status.ERROR,e)}))},t.prototype.highlightSearchResult=function(t){this.clearSearchHighlights(),this.renderSettings.searchResultItem=t,a.highlightSearchResult(t,this.renderSettings.colorTheme)},t.prototype.clearSearchHighlights=function(){a.clearSearchHighlights(),this.renderSettings.searchResultItem=null},t.prototype.attachAnchorEventHandling=function(t){for(var e=this,n=this.viewerRoot.getElementsByTagName("a"),i=function(i){var o=n[i];o.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var i=o.href.match(/^book:(\d+)$/);if(i){var r=parseInt(i[1],10);t[t.length-1].endPosition<=r?e.callOutOfBoundsAnchor():e.goToPosition(r)}else e.callLinkClicked(o.href)}))},o=0;o<n.length;o++)i(o)},t.prototype.addAccessibilityTabIndexAttribute=function(){for(var t=this.viewerRoot.querySelectorAll("[data-pid]"),e=0;e<t.length;e++)t[e].setAttribute("tabindex",(1e3+e).toString())},t.prototype.fixUpLinkStyles=function(){for(var t=this.viewerRoot.getElementsByTagName("a"),e=0;e<t.length;e++)t[e].classList.add("book-content-link");var n=this.viewerRoot.getElementsByTagName("span");for(e=0;e<n.length;e++){var i=n[e];"text-decoration: underline"===i.getAttribute("style")&&(i.removeAttribute("style"),i.classList.add("book-content-disabled-link"))}},t.prototype.buildPidPixelMaps=function(){for(var t=[],e=this.viewerRoot.querySelectorAll("[data-pid]"),n=0;n<e.length;n++){var i=e[n],o=parseInt(i.dataset.pid,10),r=!!i.dataset.imageName,s=getComputedStyle(i),a=i.getBoundingClientRect(),l=this.scrollModel.getContentOffset(this.renderSettings.viewportTopOffset),h=a.top+l,c=a.bottom+l,u={topMargin:h-(0!==parseFloat(s.marginTop)?parseFloat(s.marginTop):0),bottom:c,top:h};t.push({pid:o,pixelPositions:u,isImage:r})}this.pidSortedInfoList=t.sort((function(t,e){return t.pid-e.pid})),this.pixelSortedInfoList=t.sort((function(t,e){return t.pixelPositions.top-e.pixelPositions.top}))},t.prototype.determineImageSnapElement=function(t){var e=this.pixelSortedInfoList[t-1];if(e.isImage){var n=this.scrollModel.getScrollY();n<e.pixelPositions.bottom&&n>e.pixelPositions.top&&(t-=1)}return t},t.prototype.getFirstVisibleElement=function(){var t=s.binarySearch(this.pixelSortedInfoList,(function(t){return t.pixelPositions.top}),this.scrollModel.getScrollY());return 1<=(t=Math.min(t,this.pixelSortedInfoList.length-1))&&(t=this.determineImageSnapElement(t)),this.pixelSortedInfoList[t]},t.prototype.getFirstVisibleElementPid=function(){return this.getFirstVisibleElement().pid},t.prototype.applyRenderSettingsInternal=function(t){var n=this;if(t.viewportHeight<=0||t.viewportWidth<=0)throw new Error("Viewport height and/or viewport width is missing.");t=r({},e.DefaultRenderSettings,t);var i=this.renderSettings.font,o=i!==t.font,s=this.isReaderFontLoaded(t.font),a=this.renderSettings.colorTheme!==t.colorTheme,l=this.renderSettings.linkStyle,c=this.renderSettings.disabledLinkStyle,u=l!==t.linkStyle||c!==t.disabledLinkStyle;return this.renderSettings=r({},this.renderSettings,t),o&&!s&&h.callRenderStatusChanged(this.viewerConfig,h.Status.LOADING),this.ensureReaderFontLoaded(t.font).then((function(){h.isEqualRenderSettings(n.renderSettings,t)&&(o&&n.changeReaderFont(i,t.font),a&&(n.applyColorTheme(),t.searchResultItem&&n.highlightSearchResult(t.searchResultItem)),n.applyFontSize(t.fontSize),n.applyLineHeight(t.lineHeightFactor),n.resizeIndents(t),n.updateDropcaps(t),n.applyMargins(),n.applyAlignment(),n.fixImageDimensions(n.bookManifest.resources),u&&n.applyLinkStyles(),n.buildPidPixelMaps(),o&&!s&&h.callRenderStatusChanged(n.viewerConfig,h.Status.READY))}))},t.prototype.applyRenderSettings=function(t){var e=this;return this.applyRenderSettingsInternal(t).then((function(){e.goToPosition(e.firstVisibleElementPid)}))},t.prototype.applyHyphenation=function(t){this.viewerRoot.lang=t,this.viewerRoot.style.hyphens="auto",this.viewerRoot.style["-webkit-hyphens"]="auto",this.viewerRoot.style["-ms-hyphens"]="auto",this.viewerRoot.style["overflow-wrap"]="break-word",this.viewerRoot.style["word-wrap"]="break-word"},t.prototype.applyFontSize=function(t){document.documentElement.style.fontSize=t+"px"},t.prototype.applyLinkStyles=function(){var t=document.getElementById("reader-link-stylesheet");t&&t.remove(),document.head.appendChild(this.createReaderLinkStylesheetHTML())},t.prototype.applyLineHeight=function(t){for(var e=this.viewerRoot.querySelectorAll("div"),n=0;n<e.length;n++){var i=e[n];if(i.dataset.lh){var o=parseFloat(i.dataset.lh);i.style.lineHeight=(t*o).toString()}}},t.prototype.resizeIndents=function(t){this.viewerRoot.querySelectorAll("[data-resize-indent]").forEach((function(e){if(!("initIndent"in e.dataset)){var n=getComputedStyle(e),i=parseFloat(n.textIndent)/parseFloat(n.fontSize);e.dataset.initIndent=i+"em"}var o=s.getLargeFontSizeFactor(t.fontSize,t.viewportWidth,t.viewportHeight)*parseFloat(e.dataset.initIndent);e.style.textIndent=o+"em"}))},t.prototype.applyMargins=function(){this.sectionsContainer.style.margin=this.renderSettings.marginTop+"px "+this.renderSettings.marginRight+"px "+this.renderSettings.marginBottom+"px "+this.renderSettings.marginLeft+"px"},t.prototype.applyAlignment=function(){for(var t=this.viewerRoot.querySelectorAll("[data-is-justified]"),e=1.321<(this.renderSettings.viewportWidth-this.renderSettings.marginLeft-this.renderSettings.marginRight)/s.getAlphabetWidth(this.renderSettings.fontSize),n=0;n<t.length;n++){var i=t[n];e&&!this.renderSettings.leftAlign?i.style.textAlign="justify":i.style.textAlign="left"}},t.prototype.updateDropcaps=function(t){l.applyDropcaps(this.viewerRoot,t,this.viewerConfig.readerFonts,this.embeddedFonts)},t.prototype.applyColorTheme=function(){var t=n.COLOR_THEMES_STYLE[n.ColorTheme[this.renderSettings.colorTheme]];this.viewerRoot.style.color=t.textColor,this.viewerRoot.style.background=t.backgroundColor},t.prototype.appendCoverImage=function(t){if(t){var e='<img alt="Book cover"data-pid="1" data-is-cover-image = "true"data-image-name="'+t+'"style="width: 100%; height: 100%; object-fit: contain;">';this.viewerRoot.insertAdjacentHTML("beforeend",e)}},t.prototype.appendSections=function(t){this.sectionsContainer=document.createElement("div");for(var e=0;e<t.length;e++){var n='<div style="clear: both; margin-bottom: '+(e===t.length-1?0:"5em")+'">'+t[e]+"</div>";this.sectionsContainer.insertAdjacentHTML("beforeend",n)}this.viewerRoot.insertAdjacentElement("beforeend",this.sectionsContainer)},t.prototype.loadImages=function(){var t=this;this.viewerRoot.querySelectorAll("[data-image-name]").forEach((function(e){s.isBlockImage(e)&&(e.parentElement.style.width="100%",e.style.height&&(e.parentElement.style.minHeight=e.style.height)),t.bookProvider.getResourceUrl(e.dataset.imageName).then((function(t){e.src=t,e.hasAttribute("alt")&&!e.alt.match(/^\s*$/)||(e.alt=" ")}))}))},t.prototype.changeBackgroundImageUrls=function(){var t=this;this.viewerRoot.querySelectorAll("[data-background-image-name]").forEach((function(e){t.bookProvider.getResourceUrl(e.dataset.backgroundImageName).then((function(t){e.style.backgroundImage="url("+t+")"}))}))},t.prototype.fixImageDimensions=function(t){var e=this.viewerRoot.querySelector("[data-is-cover-image]");e&&(e.style.height=this.renderSettings.viewportHeight+"px",e.style.width=this.renderSettings.viewportWidth+"px");for(var n=this.sectionsContainer.getElementsByTagName("img"),i=function(e){var i=n[e];i.style.removeProperty("width"),i.style.removeProperty("height");var r=t.filter((function(t){if(t.name===i.dataset.imageName)return t})),a=r[0].imageWidth,l=r[0].imageHeight;"false"===i.dataset.imageHasWidth&&(i.style.width="100%"),i.style.maxWidth="100%";var h=l/a*i.clientWidth;h>o.renderSettings.viewportHeight?(i.style.height=.9*o.renderSettings.viewportHeight+"px",i.style.width=a/l*o.renderSettings.viewportHeight*.9+"px"):(i.style.height=h+"px",i.style.width=i.clientWidth+"px"),s.isBlockImage(i)&&(i.parentElement.style.width="unset",i.parentElement.style.minHeight=h+"px")},o=this,r=0;r<n.length;r++)i(r)},t.prototype.createBookStylesheetHTML=function(t){var e=document.createElement("style");return e.id="book-stylesheet",e.type="text/css",e.appendChild(document.createTextNode(t)),e},t.prototype.createReaderLinkStylesheetHTML=function(){var t=document.createElement("style");t.id="reader-link-stylesheet",t.type="text/css";var e="a.book-content-link {"+this.renderSettings.linkStyle+"}span.book-content-disabled-link {"+this.renderSettings.disabledLinkStyle+"}";return t.appendChild(document.createTextNode(e)),t},t.prototype.selectFontFormat=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];if(-1!==this.viewerConfig.supportedFontFormats.indexOf(i.format))return i}throw new Error("Can't find suitable font format")},t.prototype.setupReaderFonts=function(){for(var t in this.readerFontFaces={},this.viewerConfig.readerFonts){var e=[];if(window.FontFace)for(var n=0,i=this.viewerConfig.readerFonts[t];n<i.length;n++){var o=i[n],r=this.selectFontFormat(o.fontFiles),s=new FontFace("DefaultFont","url("+r.url+")",{style:o.fontStyle,weight:o.fontWeight,stretch:o.fontStretch});e.push(s)}this.readerFontFaces[t]=e}},t.prototype.isReaderFontLoaded=function(t){for(var e=0,n=this.readerFontFaces[t];e<n.length;e++)if("loaded"!==n[e].status)return!1;return!0},t.prototype.ensureReaderFontLoaded=function(t){return Promise.all(this.readerFontFaces[t].map((function(t){return t.load()}))).then()},t.prototype.changeReaderFont=function(t,e){if(t)for(var n=0,i=this.readerFontFaces[t];n<i.length;n++){var o=i[n];document.fonts.delete(o)}for(var r=0,s=this.readerFontFaces[e];r<s.length;r++)o=s[r],document.fonts.add(o)},t.prototype.loadEmbeddedFonts=function(){var t=this;return this.bookProvider.getResourceAsObject("fonts.json").then((function(e){return Promise.all(e.map((function(e){var n=t.selectFontFormat(e.fontFiles);return t.bookProvider.getResourceUrl(n.fileName).then((function(t){var n=s.mapYJFontWeight(e.fontWeight),i=new FontFace(e.fontFamily,"url("+t+")",{style:e.fontStyle,weight:n,stretch:e.fontStretch});return document.fonts.add(i),i.load()})).catch((function(t){console.warn(t)}))}))).then((function(){return e}))}))},t.prototype.callLinkClicked=function(t){if(this.viewerConfig.onLinkClicked)return this.viewerConfig.onLinkClicked(t)},t.prototype.callOutOfBoundsAnchor=function(){if(this.viewerConfig.onOutOfBoundsAnchor)return this.viewerConfig.onOutOfBoundsAnchor()},t.prototype.callReadingStatusChangedOnScroll=function(){this.scrollModel.isAtEndOfBook()?h.callReadingStatusChanged(this.viewerConfig,h.ReadStatus.END):h.callReadingStatusChanged(this.viewerConfig,h.ReadStatus.READING)},t.prototype.setFirstVisibleElementPid=function(){this.firstVisibleElementPid=this.getFirstVisibleElementPid()},t}();e.BookViewerReflowable=u}.apply(e,i))||(t.exports=o)},function(t,e,n){var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.bookProvider=t,this.manifest=t.getManifest()}return t.prototype.getSectionIndexByPosition=function(t){return this.manifest.then((function(e){for(var n=0;n<e.sections.length;n++){var i=e.sections[n];if(t>=i.startPosition&&t<=i.endPosition)return n}return null}))},t.prototype.getSectionMetadata=function(t){return this.manifest.then((function(e){return e.sections[t]}))},t.prototype.isLastSection=function(t){return this.manifest.then((function(e){return e.sections.length===t+1}))},t.prototype.getSectionDataByIndex=function(t){return this.bookProvider.getSectionContent(t)},t.prototype.getSectionDataByPosition=function(t){var e=this;return this.getSectionIndexByPosition(t).then((function(t){return e.getSectionDataByIndex(t)}))},t.prototype.getAllSections=function(){var t=this;return this.bookProvider.getManifest().then((function(e){return Promise.all(e.sections.map((function(e,n){return t.bookProvider.getSectionContent(n)})))}))},t.prototype.getCoverImage=function(){return this.manifest.then((function(t){return t.coverImage}))},t}();e.SectionLoader=n}.apply(e,[n,e]))||(t.exports=i)},function(t,e,n){var i,o;i=[n,e,n(4),n(0)],void 0===(o=function(t,e,n,i){"use strict";function o(t,e,n){var i=t.slice(0,e),o=t.slice(e+1,t.length);return i+n.outerHTML+o}function r(t,e){var i=document.createElement("span"),o=n.COLOR_THEMES_STYLE[n.ColorTheme[e]].searchHighlightStyle;return i.className="search-tag",i.innerHTML=t,i.style.textDecoration=o.textDecoration,i.style.backgroundColor=o.backgroundColor,i}Object.defineProperty(e,"__esModule",{value:!0});var s=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"],a=function(){function t(t){this.closeTags=[],this.descendantInfoIdx=0,this.htmlPieces=[],this.rootNode=t,this.rootString=this.rootNode.outerHTML}return t.prototype.transformString=function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent},t.prototype.getDescendants=function(){for(var t=this.rootNode.querySelectorAll("*"),e=[],n=0;n<t.length;n++){var i=h(t[n]);e.push({descendant:t[n],idx:n,tag:i})}return e},t.prototype.nextIndex=function(t,e){var n=this.rootString.length-1;this.descendantInfoIdx<t.length&&(n=this.rootString.indexOf(t[this.descendantInfoIdx].tag.open,e));var i=this.closeTags[this.closeTags.length-1],o=this.rootString.indexOf(i,e),r=e;if(n<o){var s=this.rootString.substring(e,n);this.htmlPieces.push(this.transformString(s)),this.htmlPieces.push(t[this.descendantInfoIdx].tag.open),t[this.descendantInfoIdx].tag.close&&this.closeTags.push(t[this.descendantInfoIdx].tag.close),r=n+t[this.descendantInfoIdx].tag.open.length-1,this.descendantInfoIdx++}else o<n&&(s=this.rootString.substring(e,o),this.htmlPieces.push(this.transformString(s)),this.htmlPieces.push(i),r=o+i.length-1,this.closeTags.length&&this.closeTags.pop());return r},t.prototype.findHtmlPieces=function(){var t=this.getDescendants(),e=h(this.rootNode);e.close&&this.closeTags.push(e.close),this.htmlPieces.push(e.open);for(var n=e.open.length;n<this.rootString.length;n++)n=this.nextIndex(t,n);return e.close&&this.htmlPieces.push(e.close),this.htmlPieces},t}(),l=function(){function t(t,e){this.appearanceIndex=t.appearancesInPid,this.htmlPieces=e,this.keyword=t.keyword.toLowerCase(),this.keywordPositions=[],this.keywordStartPositionCandidates=[],this.tempKeywordInfo={keyword:"",appearanceIndex:0},this.visitedHtmlPieceIdx=[]}return t.prototype.updateStartPositionCandidates=function(t,e){var n={htmlPieceIdx:e,characterIdx:t};this.keywordStartPositionCandidates.some((function(t){return t===n}))||this.keywordStartPositionCandidates.push(n)},t.prototype.getKeywordStatus=function(t){return this.tempKeywordInfo.keyword+=t,this.tempKeywordInfo.keyword===this.keyword?(this.tempKeywordInfo.appearanceIndex++,this.tempKeywordInfo.appearanceIndex===this.appearanceIndex?i.KeywordStatus.FOUND:i.KeywordStatus.IMPOSSIBLE):0===this.keyword.indexOf(this.tempKeywordInfo.keyword)?i.KeywordStatus.POSSIBLE:i.KeywordStatus.IMPOSSIBLE},t.prototype.nextKeywordStartPosition=function(t){var e=this.keywordStartPositionCandidates.shift();return this.visitedHtmlPieceIdx=this.visitedHtmlPieceIdx.slice(0,t+1),e},t.prototype.newKeywordPositionInfo=function(t,e,n){for(var o=t;o<e.length;o++){var r=e[o];r===this.keyword[0]&&this.tempKeywordInfo.keyword.length&&this.updateStartPositionCandidates(o,n),this.keywordPositions.push({htmlPieceIdx:n,characterIdx:o});var s=this.getKeywordStatus(r);if(s===i.KeywordStatus.FOUND)return{status:s,nextKeywordStartPosition:null};if(s===i.KeywordStatus.IMPOSSIBLE&&(this.tempKeywordInfo.keyword="",this.keywordPositions=[],this.keywordStartPositionCandidates.length))return{status:s,nextKeywordStartPosition:this.nextKeywordStartPosition(n)}}return{status:i.KeywordStatus.POSSIBLE,nextKeywordStartPosition:null}},t.prototype.findKeywordPositions=function(){for(var t=0,e=1,n=null;e!==this.htmlPieces.length-1;)if(this.htmlPieces[e].length){var o=this.htmlPieces[e].toLowerCase();if(this.visitedHtmlPieceIdx.some((function(t){return t===e}))||(t=0,this.visitedHtmlPieceIdx.push(e)),(n=this.newKeywordPositionInfo(t,o,e)).status===i.KeywordStatus.FOUND)return this.keywordPositions;var r=n.nextKeywordStartPosition;r?(e=r.htmlPieceIdx,t=r.characterIdx):e+=2}else e+=2;return this.keywordPositions},t}(),h=function(t){var e=t.tagName,n=t.outerHTML,i=t.innerHTML;if(s.some((function(t){return t===e.toLowerCase()})))return{open:n,close:null};var o="</"+e.toLowerCase()+">";return{open:n.substring(0,n.length-(i+o).length),close:o}};e.highlightSearchResult=function(t,e){var n='[data-pid="'+t.pidIndex+'"]',i=document.querySelector(n),s=new a(i).findHtmlPieces(),h=new l(t,s).findKeywordPositions();i.outerHTML=function(t,e,n){for(var i=t.length-1;0<=i;i--){var s=t[i].htmlPieceIdx,a=e[s],l=t[i].characterIdx,h=r(a[l],n);e[s]=o(a,l,h)}return e.join("")}(h,s,e)},e.clearSearchHighlights=function(){var t=document.getElementsByClassName("search-tag");if(0<t.length)for(var e=t.length-1;0<=e;e--){var n=h(t[e]),i=t[e],o=i.parentElement,r=o.innerHTML,s=r.indexOf(t[e].outerHTML),a=s+n.open.length,l=s+n.open.length+n.close.length+i.innerHTML.length;o.innerHTML=r.substring(0,s)+r[a]+r.substring(l,r.length)}}}.apply(e,i))||(t.exports=o)},function(t,e,n){var i,o;i=[n,e,n(2)],void 0===(o=function(t,e,n){"use strict";function i(t,e,n,i,o){for(var r=0,s=t;r<s.length;r++){var a=s[r];if(a.fontFamily===e&&(a.fontWeight===n||!a.fontWeight&&"normal"===n)&&(a.fontStyle===i||!a.fontStyle&&"normal"===i)&&(a.fontStretch===o||!a.fontStretch&&"normal"===o))return a.fontMetrics}return null}function o(t,e){for(var n=0,i=e.glyphMetrics;n<i.length;n++){var o=i[n];if(o.glyph===t)return o}}function r(t,e,n,i,o,r){for(s(t,e,n,i,o);t.offsetWidth>.6*r&&1<o;)s(t,e,n,i,--o)}function s(t,e,n,i,r){if(1===r||!i||!n)return t.style.fontFamily="unset",t.style.cssFloat="unset",t.style.fontSize="unset",t.style.lineHeight="unset",void(t.style.marginTop="unset");for(var s=n.ascent/n.unitsPerEm,a=-n.descent/n.unitsPerEm,l=n.capHeight/n.unitsPerEm,h=i.capHeight/i.unitsPerEm,c=i.ascent/i.unitsPerEm,u=-i.descent/i.unitsPerEm,d=null,p=null,g=0,f=0,v=t.innerHTML;f<v.length;f++){var m=o(v[f],n);if(null==m){g=p=d=null;break}var y=m.yMax/n.unitsPerEm,S=-m.yMin/n.unitsPerEm;d<y&&(d=y),p<S&&(p=S),g+=(m.xMax-m.xMin)/n.unitsPerEm}var E=(r-1)*e+h,P=E/l,w=0;null!=p&&u<p*P&&(P=(E+u)/(l+p),w+=p);var C=s-a-(r*e-(e-(c+u))/2-u)/P+w;t.style.cssFloat="left",t.style.fontSize=P+"em",t.style.lineHeight=(s-a).toString(),t.style.marginTop=-C+"em",t.style.height=E/P+C+"em",0<g&&(t.style.width=g+"em"),t.style.marginRight=.6*(e-h)/P+"em"}function a(t,e,n){var i=getComputedStyle(t),o=parseFloat(i.lineHeight);0<o&&1===Math.round(t.clientHeight/o)?t.dataset.dcKnockout=e.offsetWidth+"px":delete t.dataset.dcKnockout;var r=t.previousElementSibling;if(r){var s=parseFloat(r.dataset.dcKnockout);s&&s+e.offsetWidth<=.6*n?e.style.marginLeft=s+"px":e.style.marginLeft="unset"}}Object.defineProperty(e,"__esModule",{value:!0}),e.applyDropcaps=function(t,e,o,s){for(var l=t.querySelectorAll("div"),h=0;h<l.length;h++){var c=l[h];if(c.dataset.dropcapFontFamily&&c.dataset.dropcapLines&&c.dataset.dropcapChars){var u=n.getFirstElementChild(c);if(u&&"SPAN"===u.tagName){var d=c.dataset.dropcapFontFamily,p=parseInt(c.dataset.dropcapLines),g=c.dataset.dropcapFontWeight||"normal",f=c.dataset.dropcapFontStyle||"normal",v=c.dataset.dropcapFontStretch||"normal",m=parseFloat(c.dataset.lh)*e.lineHeightFactor,y=i(o[e.font],e.font,g,f,v),S=y;"default"!==d&&(S=i(s,d,g,f,v)),null!=S&&(r(u,m,S,y,p,e.viewportWidth),a(c,u,e.viewportWidth))}}}}}.apply(e,i))||(t.exports=o)}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(i,o,function(t){return e[t]}.bind(null,o));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=5);function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e,n}()},286:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return s}));var i,o=n(20);!function(t){t.READY="ready",t.LOADING="loading",t.ERROR="error"}(i||(i={}));var r=function(t){switch(t){case"reading":return o.c.READING;case"end":return o.c.END;default:return o.c.READING}},s=function(t){switch(t){case i.LOADING:return o.d.STATUS_LOADING;case i.READY:return o.d.STATUS_IDLE;case i.ERROR:default:return o.d.STATUS_ERROR}}}}]);